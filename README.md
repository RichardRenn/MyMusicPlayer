# MyMusicPlayer

一个功能完整的iOS本地音乐播放器应用程序，支持播放本地MP3文件、显示LRC歌词以及树状结构浏览音乐文件。

## 功能特点

- **智能文件夹选择**：提供直观的文件系统浏览界面，轻松选择包含音乐的文件夹
- **高效音乐扫描**：递归扫描选定文件夹及其所有子文件夹中的MP3文件和LRC歌词文件
- **树状目录结构**：以层级树状结构展示所有音乐文件和文件夹，支持子文件夹的展开与折叠
- **多样化播放模式**：支持顺序播放、单曲循环和随机播放三种播放模式
- **播放范围控制**：可锁定播放范围在当前歌曲所在目录内，避免随机跳转到其他目录
- **歌词同步显示**：播放时实时同步显示LRC歌词，支持自动滚动和高亮当前播放行
- **完整播放控制**：提供播放/暂停、上一曲、下一曲、播放模式切换等基本控制功能

## 技术栈

- **开发语言**：Swift 5
- **UI框架**：UIKit
- **音频处理**：AVFoundation
- **文件管理**：FileManager
- **数据存储**：UserDefaults（用于保存用户设置）

## 快速开始

### 前提条件

- Xcode 14.0 或更高版本
- iOS 15.0 或更高版本
- macOS 12.0 或更高版本（用于开发）

### 安装与运行

1. 克隆或下载本项目代码到本地
2. 使用Xcode打开项目文件 `MyMusicPlayer.xcodeproj`
3. 在Xcode中选择目标设备（iOS模拟器或真实设备）
4. 点击运行按钮（▶️）编译并启动应用程序

## 使用指南

### 1. 选择音乐文件夹

首次启动应用时，系统将显示文件夹选择界面。点击「选择文件夹」按钮，在弹出的文件浏览器中导航并选择包含音乐文件的文件夹。

### 2. 音乐扫描过程

选择文件夹后，应用将自动开始扫描该文件夹及其所有子文件夹中的MP3文件。扫描过程中，屏幕会显示进度指示器，显示当前扫描的路径和总体进度。扫描完成后，音乐文件将以树状结构显示在列表中。

### 3. 浏览音乐列表

- **查看目录结构**：扫描完成后，您将看到以树状结构组织的音乐文件和子文件夹
- **展开/折叠文件夹**：点击文件夹名称左侧的箭头图标或直接点击文件夹名称，可以展开或折叠该文件夹
- **子文件夹显示**：子文件夹将以缩进方式显示，清晰表达目录层次关系
- **播放音乐文件**：点击任何MP3文件即可开始播放

### 4. 播放控制功能

- **底部播放横幅**：始终显示当前播放歌曲的标题和艺术家信息
- **控制按钮**：提供上一曲、播放/暂停、下一曲等基本控制按钮
- **播放模式切换**：点击播放模式按钮可在顺序播放、单曲循环和随机播放之间切换
- **播放范围锁定**：点击锁定按钮可限制播放范围在当前歌曲所在目录内

### 5. 歌词显示功能

点击底部播放横幅，可以进入播放详情页面，查看当前歌曲的LRC歌词。歌词将随着音乐播放进度自动滚动，并高亮显示当前正在播放的歌词行。

## 注意事项

- **权限要求**：应用首次运行时需要文件系统访问权限，请确保在弹出的权限请求对话框中选择「允许访问」
- **歌词文件要求**：歌词文件必须与对应的MP3文件同名，且扩展名为.lrc（例如："歌曲.mp3"对应"歌曲.lrc"）
- **支持格式**：目前应用仅支持MP3格式的音频文件和标准格式的LRC歌词文件
- **扫描性能**：扫描大量音乐文件时可能需要较长时间，请耐心等待

## 项目结构

```
MyMusicPlayer/
├── MyMusicPlayer/
│   ├── AppDelegate.swift                 # 应用程序生命周期管理
│   ├── SceneDelegate.swift               # 场景会话管理
│   ├── ViewController.swift              # 初始文件夹选择视图控制器
│   ├── MusicListViewController.swift     # 音乐列表和播放控制视图控制器
│   ├── MusicPlayerViewController.swift   # 播放详情和歌词显示视图控制器
│   ├── MusicPlayer.swift                 # 音乐播放器核心逻辑和状态管理
│   ├── MusicScanner.swift                # 音乐文件和歌词扫描器
│   ├── MusicItem.swift                   # 音乐文件数据模型
│   ├── LyricsParser.swift                # LRC歌词解析器
│   ├── CoreTypes.swift                   # 核心数据类型定义
│   ├── Info.plist                        # 应用配置信息
│   └── Base.lproj/
│       ├── Main.storyboard               # 主界面故事板
│       └── LaunchScreen.storyboard       # 启动界面故事板
├── MyMusicPlayer.xcodeproj/              # Xcode项目文件
└── README.md                             # 项目说明文档
```

## 许可证

本项目仅供学习、研究和参考使用。任何商业用途请先联系作者获取授权。
